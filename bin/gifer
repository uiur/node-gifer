#!/usr/bin/env node
'use strict';

var program = require('commander')
  , gifer = require('../index')
  , pkg = require('../package')
  , path = require('path');

program
  .version(pkg.version)
  .usage('[options] input output')
  .option('-d, --delay [delay]', 'delay between frames [auto]', parseInt)
  .option('-r, --rate [rate]', 'frame rate [10]', parseInt)
  .option('-t, --tmpdir [path]', 'a directory used to put video frames [/tmp/uidxxx/]')
  .parse(process.argv);

if (program.args.length < 1) {
  program.help();
}

var input = program.args.shift()
  , output = program.args.shift();

if (!output) {
  output = path.basename(input, path.extname(input)) + '.gif';
}

var options = {
  delay: program.delay,
  rate: program.rate,
  tmpdir: program.tmpdir
}

gifer(input, output, options, function (err) {
  if (err) throw err;

  console.log(output);
});